<html>
	<body>
		<form name='searchForm' action="http://www.imdb.com/search/title" onsubmit="return false">
			<br/>
			<button type="button" onclick="formSubmit(event)">Search</button> for the 
			<select id="sort_movies">
				<option value="user_rating" selected="selected">highest rated</option>
				<option value="moviemeter" >most popular</option>
			</select>
			movies of the last
			<select id="released_years_ago">
				<option value="1">1</option>
				<option value="5">5</option>
				<option value="10" selected="selected">10</option>
				<option value="25">25</option>
				<option value="50">50</option>
				<option value="150">150</option>
			</select>
			year(s).
			<br/>
			<br/>
			Show all results with at least
			<select id="movie_rating">
				<option value="8.0">8.0</option>
				<option value="7.0" selected="selected">7.0</option>
				<option value="6.0">6.0</option>
				<option value="5.0">5.0</option>
				<option value="1.0">1.0</option>
			</select>
			rating and
			<select id="number_of_votes">
				<option value="100000">100000</option>
				<option value="10000">10000</option>
				<option value="1000" selected="selected">1000</option>
				<option value="100">100</option>
				<option value="0">0</option>
			</select>
			votes.
			<br/>
			<br/>
			Look for all these genres: (all if none checked)
			<br/>
			<br/>
			<table>
			  <tbody>
			    <tr>
			      <td>
			        <input id="genres-1" type="checkbox" name="genres" value="action">
			        <label for="genres-1">Action</label>
			      </td>
			      <td>
			        <input id="genres-2" type="checkbox" name="genres" value="adventure">
			        <label for="genres-2">Adventure</label>
			      </td>
			      <td>
			        <input id="genres-3" type="checkbox" name="genres" value="animation">
			        <label for="genres-3">Animation</label>
			      </td>
			    </tr>
			    <tr>
			      <td>
			        <input id="genres-4" type="checkbox" name="genres" value="biography">
			        <label for="genres-4">Biography</label>
			      </td>
			      <td>
			        <input id="genres-5" type="checkbox" name="genres" value="comedy">
			        <label for="genres-5">Comedy</label>
			      </td>
			      <td>
			        <input id="genres-6" type="checkbox" name="genres" value="crime">
			        <label for="genres-6">Crime</label>
			      </td>
			    </tr>
			    <tr>
			      <td>
			        <input id="genres-7" type="checkbox" name="genres" value="drama">
			        <label for="genres-7">Drama</label>
			      </td>
			      <td>
			        <input id="genres-8" type="checkbox" name="genres" value="family">
			        <label for="genres-8">Family</label>
			      </td>
			      <td>
			        <input id="genres-9" type="checkbox" name="genres" value="fantasy">
			        <label for="genres-9">Fantasy</label>
			      </td>
			    </tr>
			    <tr>
			      <td>
			        <input id="genres-10" type="checkbox" name="genres" value="film_noir">
			        <label for="genres-10">Film-Noir</label>
			      </td>
			      <td>
			        <input id="genres-11" type="checkbox" name="genres" value="history">
			        <label for="genres-11">History</label>
			      </td>
			      <td>
			        <input id="genres-12" type="checkbox" name="genres" value="horror">
			        <label for="genres-12">Horror</label>
			      </td>
			    </tr>
			    <tr>
			      <td>
			        <input id="genres-13" type="checkbox" name="genres" value="music">
			        <label for="genres-13">Music</label>
			      </td>
			      <td>
			        <input id="genres-14" type="checkbox" name="genres" value="musical">
			        <label for="genres-14">Musical</label>
			      </td>
			      <td>
			        <input id="genres-15" type="checkbox" name="genres" value="mystery">
			        <label for="genres-15">Mystery</label>
			      </td>
			    </tr>
			    <tr>
			      <td>
			        <input id="genres-16" type="checkbox" name="genres" value="romance">
			        <label for="genres-16">Romance</label>
			      </td>
			      <td>
			        <input id="genres-17" type="checkbox" name="genres" value="sci_fi">
			        <label for="genres-17">Sci-Fi</label>
			      </td>
			      <td>
			        <input id="genres-18" type="checkbox" name="genres" value="sport">
			        <label for="genres-18">Sport</label>
			      </td>
			    </tr>
			    <tr>
			      <td>
			        <input id="genres-19" type="checkbox" name="genres" value="thriller">
			        <label for="genres-19">Thriller</label>
			      </td>
			      <td>
			        <input id="genres-20" type="checkbox" name="genres" value="war">
			        <label for="genres-20">War</label>
			      </td>
			      <td>
			        <input id="genres-21" type="checkbox" name="genres" value="western">
			        <label for="genres-21">Western</label>
			      </td>
			    </tr>
			  </tbody>
			</table>
			<br/>
			Don't look for any of these genres:
			<br/>			
			<br/>			
			<table>
			  <tbody>
			    <tr>
			      <td>
			        <input id="ngenres-1" type="checkbox" name="!genres" value="action">
			        <label for="ngenres-1">Action</label>
			      </td>
			      <td>
			        <input id="ngenres-2" type="checkbox" name="!genres" value="adventure">
			        <label for="ngenres-2">Adventure</label>
			      </td>
			      <td>
			        <input id="ngenres-3" type="checkbox" name="!genres" value="animation" checked>
			        <label for="ngenres-3">Animation</label>
			      </td>
			    </tr>
			    <tr>
			      <td>
			        <input id="ngenres-4" type="checkbox" name="!genres" value="biography">
			        <label for="ngenres-4">Biography</label>
			      </td>
			      <td>
			        <input id="ngenres-5" type="checkbox" name="!genres" value="comedy">
			        <label for="ngenres-5">Comedy</label>
			      </td>
			      <td>
			        <input id="ngenres-6" type="checkbox" name="!genres" value="crime">
			        <label for="ngenres-6">Crime</label>
			      </td>
			    </tr>
			    <tr>
			      <td>
			        <input id="ngenres-7" type="checkbox" name="!genres" value="drama">
			        <label for="ngenres-7">Drama</label>
			      </td>
			      <td>
			        <input id="ngenres-8" type="checkbox" name="!genres" value="family">
			        <label for="ngenres-8">Family</label>
			      </td>
			      <td>
			        <input id="ngenres-9" type="checkbox" name="!genres" value="fantasy">
			        <label for="ngenres-9">Fantasy</label>
			      </td>
			    </tr>
			    <tr>
			      <td>
			        <input id="ngenres-10" type="checkbox" name="!genres" value="film_noir">
			        <label for="ngenres-10">Film-Noir</label>
			      </td>
			      <td>
			        <input id="ngenres-11" type="checkbox" name="!genres" value="history">
			        <label for="ngenres-11">History</label>
			      </td>
			      <td>
			        <input id="ngenres-12" type="checkbox" name="!genres" value="horror" checked>
			        <label for="ngenres-12">Horror</label>
			      </td>
			    </tr>
			    <tr>
			      <td>
			        <input id="ngenres-13" type="checkbox" name="!genres" value="music">
			        <label for="ngenres-13">Music</label>
			      </td>
			      <td>
			        <input id="ngenres-14" type="checkbox" name="!genres" value="musical" checked>
			        <label for="ngenres-14">Musical</label>
			      </td>
			      <td>
			        <input id="ngenres-15" type="checkbox" name="!genres" value="mystery">
			        <label for="ngenres-15">Mystery</label>
			      </td>
			    </tr>
			    <tr>
			      <td>
			        <input id="ngenres-16" type="checkbox" name="!genres" value="romance">
			        <label for="ngenres-16">Romance</label>
			      </td>
			      <td>
			        <input id="ngenres-17" type="checkbox" name="!genres" value="sci_fi">
			        <label for="ngenres-17">Sci-Fi</label>
			      </td>
			      <td>
			        <input id="ngenres-18" type="checkbox" name="!genres" value="sport">
			        <label for="ngenres-18">Sport</label>
			      </td>
			    </tr>
			    <tr>
			      <td>
			        <input id="ngenres-19" type="checkbox" name="!genres" value="thriller">
			        <label for="ngenres-19">Thriller</label>
			      </td>
			      <td>
			        <input id="ngenres-20" type="checkbox" name="!genres" value="war">
			        <label for="ngenres-20">War</label>
			      </td>
			      <td>
			        <input id="ngenres-21" type="checkbox" name="!genres" value="western">
			        <label for="ngenres-21">Western</label>
			      </td>
			    </tr>
			  </tbody>
			</table>
			<br/>
			From:
			<br/>

			<select multiple name="countries" id="countries" size=10>
			<option value="fr" >France</option>
			<option value="de" >Germany</option>
			<option value="hu" >Hungary</option>
			<option value="jp" >Japan</option>
			<option value="ru" >Russia</option>
			<option value="kr" >South Korea</option>
			<option value="gb" >United Kingdom</option>
			<option value="us" >United States</option>
			</select>
			<br/>
			<br/>
			<a id="hoverover" style="cursor:default;" onMouseOver="ShowPopup(this);" onMouseOut="HidePopup();">Keywords:</a>

			<div id="hoverpopup" style="visibility:hidden; position:absolute; top:0; left:0;"><table bgcolor="#819FF7">
			<tr><td><font color="#FFFFFF">Note</font></td></tr>
			<tr><td bgcolor="#E6E6E6">Example:<br>based-on-novel,motivation,optimist,following-a-dream<br><br>Use "-" for multi word keywords and separate each keyword with commas.</td></tr></table></div>
			<br/><input type="text" name="keywords" id="keywords" size="70"><br/>
			<br/>
		</form>
		<script>
var formSubmit = function(event) {
	event.preventDefault();
	event.stopPropagation();

	var url = document.querySelector('form').action + '?';
	var urlParams = [];

	// Core inputs
	var yearsToSubtract = parseInt(document.getElementById("released_years_ago").value, 10);
	var sortValue = document.getElementById("sort_movies").value;
	var sortType = (sortValue === "user_rating") ? ",desc" : ",asc";
	var ratingValue = document.getElementById("movie_rating").value;
	var votesValue = document.getElementById("number_of_votes").value;

	// --- Genres ---
	var includeGenres = joinChecked(searchForm.genres, ',');
	var defaultExcluded = ['documentary', 'game_show', 'news', 'reality_tv', 'talk_show'];
	var userExcluded = joinChecked(searchForm['!genres'], ',');
	var excludeGenres = defaultExcluded.join(',') + (userExcluded ? ',' + userExcluded : '');
	let genreParts = [];

	if (excludeGenres) {
		genreParts.push(...excludeGenres.split(',').map(g => `!${g}`));
	}
	if (includeGenres) {
		genreParts.push(...includeGenres.split(','));
	}
	if (genreParts.length > 0) {
		urlParams.push('genres=' + genreParts.join(','));
	}

	// --- Countries ---
	var includedCountries = loopSelected("countries");
	if (includedCountries.length > 0) {
		urlParams.push('country_of_origin=' + includedCountries.join(','));
	}

	urlParams.push('country_of_origin=!IN,!BD,!TR,!PK');

	// --- Keywords ---
	var keywords = document.getElementById('keywords').value.trim();
	if (keywords) {
		urlParams.push('keywords=' + encodeURIComponent(keywords));
	}

	// --- Other settings ---
	//urlParams.push('title_type=feature,tv_movie,video');
	urlParams.push('title_type=feature');
	urlParams.push('my_ratings=exclude');
	urlParams.push('production_status=released');
	urlParams.push('count=100');
	urlParams.push('sort=' + sortValue + sortType);
	urlParams.push('release_date=' + (2025 - yearsToSubtract) + ',');
	urlParams.push('user_rating=' + ratingValue + ',');
	urlParams.push('num_votes=' + votesValue + ',');

	url += urlParams.join('&');
	window.open(url, '_blank');
	return false;
};

// Helpers

function loopSelected(selectId) {
	var selected = [];
	var selObj = document.getElementById(selectId);
	for (var i = 0; i < selObj.options.length; i++) {
		if (selObj.options[i].selected) {
			selected.push(selObj.options[i].value);
		}
	}
	return selected;
}

function joinChecked(group, delimiter) {
	if (!group) return '';
	if (!group.length) group = [group]; // handle single checkbox
	var values = [];
	for (var i = 0; i < group.length; i++) {
		if (group[i].checked) {
			values.push(group[i].value);
		}
	}
	return values.join(delimiter);
}
</script>
	</body>
</html>
